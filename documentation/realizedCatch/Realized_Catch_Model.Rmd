---
title: "Realized Catch Model"
output:  html_notebook
---


## Introduction
A component of the operating model for the New England groundfish management strategy evaluation is a realized catch model.  This model applies an implementation error to convert the allowable catch limit for a stock into the realized catch of that stock.

In the case of a multispecies fisheries like the New England groundfish fisheries the catch of a stock may be a function not just of the ACL for that stock, but the catch or ACL for other stocks in the multispecies fishery.  We fit multivariate regressions to the available catch and ACL data as a means of predicting this interaction between stocks in the NE groundfish fishery.

## Data
Catch history data was downloaded from the Greater Atlantic Regional Fisheries Office year end catch accounting website for the New England multispecies (groundfish) fishery (https://www.greateratlantic.fisheries.noaa.gov/aps/monitoring/nemultispecies.html).  We downloaded data from 8 years of data available, for the 2010-2017 fiscal years, in the Year-End Groundfish Catch Accounting pdf files.

Data was extracted from these files and converted into a tidy usable format using R and the script in the wrangleCatchACL.R file.  This file extracts the five relevant data tables from each pdf, creating 5 data tables in R, one each for catch, ACL, the ratio of catch to ACL, landings, and discards, for 25 stocks:

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(VGAM)
library(knitr)

catchHist<-read_csv("C:/Users/jcummings/OneDrive - UMASS Dartmouth/SMAST/Research/groundfish-MSE/data/data_processed/catchHistory/catchHist.csv")
catchHist <- catchHist %>% 
  select(Stock, Total, Year, data_type) %>% #select columns of interest
  rename_all(tolower) %>% #make all names lowercase
  mutate(stock = tolower(stock))
stocks<-data.frame(stocks=unique(catchHist$stock))
kable(stocks,caption="New England Multispecies stocks")
```

This results in the following data for each stock:
```{r, echo=FALSE, message=FALSE}
gbcod_data <- catchHist %>% 
  filter(grepl("gb cod",stock)) %>% 
  spread(data_type,total)
kable(gbcod_data,caption="George's Bank Cod data")
```

```{r, echo=FALSE, message=FALSE}
mydata <- catchHist %>% 
  filter(grepl(paste(c("cod","haddock"), collapse="|"),stock))
ggplot(mydata, aes(x=year, y=total, group=data_type, color=data_type)) +
  geom_line() +
  facet_wrap(~stock,scales = "free")
```



## Realized Catch Modeling Methodology



# Markdown help

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
